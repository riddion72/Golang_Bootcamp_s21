# Техническое задание

## Задание 00: Масштабируемость

### Описание задачи
Создать систему, состоящую из клиента и экземпляра базы данных, которая поддерживает масштабируемость и отказоустойчивость. Основные функции включают управление процессами, механизм пульсации и осведомленность о нодах.

### Требования
1. **Доступ через командную строку**
   - Реализовать программу с REPL (Read-Eval-Print Loop).
   - Подключение к работающему экземпляру базы данных через сеть (локальный хост и порт).

2. **Управление процессами**
   - Возможность завершения любого экземпляра базы данных.
   - Настраиваемый параметр: фактор репликации (по умолчанию 2).

3. **Механизм пульсации**
   - Клиент должен выполнять пульсации для проверки доступности экземпляра базы данных.
   - Автоматическое переключение на другой экземпляр в случае недоступности текущего.

4. **Осведомленность о нодах**
   - Клиент должен знать обо всех других узлах.
   - Ответ на пульсацию должен включать адреса и порты всех экземпляров и текущий фактор репликации.

5. **Запуск новых экземпляров**
   - При запуске нового экземпляра указывать существующий экземпляр.
   - Обмен адресами между узлами после получения пульсации.

6. **Проверка фактора репликации**
   - Узлы должны завершать работу, если фактор репликации отличается от существующих узлов.

7. **Сетевой протокол**
   - Использовать любой сетевой протокол (HTTP, gRPC и т.д.).

8. **Уведомления о проблемах с репликацией**
   - Если фактор репликации больше, чем количество работающих узлов, информация должна быть включена в пульсацию.

---

## Задание 01: Балансировка и Запросы

### Описание задачи
Реализовать базу данных, поддерживающую операции GET, SET и DELETE с использованием UUID4 в качестве ключей.

### Требования
1. **Операции базы данных**
   - **SET**: Если ключ существует, значение перезаписывается. Должна быть обеспечена консистентность чтения после записи.
   - **GET**: Возвращает значение по ключу.
   - **DELETE**: Удаляет значение по ключу.

2. **Обработка ошибок**
   - Если запись не может быть выполнена, клиент должен получить соответствующее сообщение об ошибке.

3. **Консистентность данных**
   - При обновлении или удалении значений реализовать конечную консистентность.

4. **Балансировка нагрузки**
   - Реализовать хеширование ключей для распределения данных по узлам в соответствии с фактором репликации.

5. **Переключение узлов**
   - Если текущий узел остановлен, клиент должен автоматически запросить другой доступный узел.

---

## Задание 02: Да здравствует король

### Описание задачи
Ввести концепции узла Лидера и Узла Подписчика.

### Требования
1. **Взаимодействие с узлом Лидера**
   - Клиент взаимодействует только с узлом Лидером.
   - Лидер отвечает за хеш-функцию для записи реплик.

2. **Пульсации между узлами**
   - Узлы продолжают отправлять друг другу пульсации с полным списком узлов.

3. **Выбор нового Лидера**
   - Если Лидер остановлен, оставшиеся Подписчики выбирают нового Лидера.

4. **Обработка ошибок подключения**
   - Если клиент не может подключиться к Лидеру, он должен попытаться подключиться к Подписчикам.

---

## Задание 03: Консенсус (Бонус)

### Описание задачи
Устранить проблемы гонок условий и потери данных при репликации.

### Требования
1. **Использование существующих решений**
   - Рассмотреть возможность использования Raft, Zookeeper, Etcd или Paxos для обеспечения консенсуса.

---

### Заключение
Данное техническое задание описывает основные требования и функциональность для реализации системы с поддержкой масштабируемости и отказоустойчивости. Каждое задание должно быть выполнено последовательно, начиная с базовых функций и заканчивая более сложными концепциями консенсуса.